<link rel="import" href="../polymer/polymer.html">

<!--
A Polymer element for masking the images with basic (and some extraordinary) geometric shapes

##### Example

<image-mask shape="circle" size="320" src="img/image.jpg" href="#" title="A short description of an image" desc="A long description of an image"></image-mask>

@element image-mask
@blurb A Polymer element for masking the images with basic (and some extraordinary) geometric shapes
@status beta
@homepage https://github.com/hejty/image-mask
-->

<polymer-element name="image-mask" attributes="shape size src href title desc">

	<template>
	    <svg width="{{size}}" height="{{size}}" viewBox="0 0 {{size}} {{size}}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" role="img" aria-labelledby="title desc">
			<title id="title">{{title}}</title>
			<desc id="desc">{{desc}}</desc>

			<defs>
				<clipPath id="{{maskId}}">
					<template if="{{shape == 'circle'}}">
						<circle r="50%" cx="50%" cy="50%"/>
					</template>

					<template if="{{shape == 'triangle'}}">
						<polygon points="0,{{size}} {{size/2}},0 {{size}},{{size}}" />
					</template>

					<template if="{{shape == 'square'}}">
						<rect x="0" y="0" width="{{size}}" height="{{size}}" />
					</template>

					<template if="{{shape == 'rhombus'}}">
						<polygon points="{{size}},{{size/2}} {{size/2}},{{size}} 0,{{size/2}} {{size/2}},0" />
					</template>

					<template if="{{shape == 'hexagon'}}">
						<polygon points="{{size/1.155}},{{size/1.33}} {{size/2.3}},{{size}} 0,{{size/1.33}} 0,{{size/4}} {{size/2.3}},0 {{size/1.155}},{{size/4}}" />
					</template>

					<template if="{{shape == 'star'}}">
						<polygon points="{{size/2}},0 {{size/1.618}},{{size/2.752}} {{size}},{{size/2.752}} {{size/1.447}},{{size/1.701}} {{size/1.236}},{{size/1.051}} {{size/2}},{{size/1.376}} {{size/5.236}},{{size/1.051}} {{size/3.236}},{{size/1.701}} 0,{{size/2.752}} {{size/2.618}},{{size/2.752}}" />
					</template>

					<template if="{{shape == 'parallelogram'}}">
						<polygon points="{{size/4}},0 {{size}},0 {{size/1.33}},{{size}} 0,{{size}}" />
					</template>
				</clipPath>
			</defs>

			<a xlink:href="{{href}}" id="link" xlink:title="{{title}}">
				<image clip-path="url(#{{maskId}})" height="100%" width="100%" xlink:href="{{src}}" preserveAspectRatio="xMidYMid slice" />
			</a>
		</svg>
    </template>

    <script>
        Polymer('image-mask', {
			/**
			* The `shape` attribute sets a masking shape
			*
			* @attribute shape
			* @type string
			* @default 'circle'
			*/
			shape: 'circle',

			/**
			* The `size` attribute sets a size of element
			*
			* @attribute size
			* @type int
			* @default 320
			*/
			size: 320,

			/**
			*  The `src` attribute defines a path to an image that will be masked
			*
			* @attribute src
			* @type string
			* @default http://placehold.it/320
			*/
			src: 'http://placehold.it/' + this.size,

			/**
			*  The `href` attribute sets the target URL
			*
			* @attribute href
			* @type string
			* @default
			*/
			href: null,

			/**
			*  The `title` attribute sets a short description of an image. (It's not rendered visually by default.)
			*
			* @attribute title
			* @type string
			* @default
			*/
			title: '',

			/**
			*  The `desc` attribute sets a long description of an image. (It's not rendered visually by default.)
			*
			* @attribute desc
			* @type string
			* @default
			*/
			desc: '',

			// Fires when the `<image-mask>` has been fully prepared
			ready: function() {
				// Generate unique `id` for clipPath tag to deal with another intance of `image-mask` element on the page
				this.maskId = 'mask-' + Math.random().toString(36).substr(2, 5);

				// Remove link target attribute if an `href` attribute is not defined
				if(!this.href) {
					this.href = this.$.link.removeAttribute('xlink:href');
				}
			}
		});
    </script>

</polymer-element>
